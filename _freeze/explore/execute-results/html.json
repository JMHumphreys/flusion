{
  "hash": "6e24c7a27df1de49b57e75aba5083da4",
  "result": {
    "markdown": "---\ntitle: \"Explore the Data\"\ndescription: \"Data set description.\"\nformat:\n  html:\n    df-print: kable\n    code-fold: true\n    code-summary: \"Show code\"\n    code-overflow: wrap\n    toc-title: Page Contents\n    toc: true\n    toc-depth: 2\n    toc-location: right\n    number-sections: false\n    html-math-method: katex\n    css: styles.css\n    theme: flatly\n    smooth-scroll: true\neditor_options: \n  chunk_output_type: console\n---\n\n\n# Overview\n\nThis page provides plots and figures describing the contents of the f(l)usion data set.\n\n## Data description:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\noptions(dplyr.summarise.inform = FALSE, show_col_types = FALSE)\n\nget_fusion <- function(url) {\n  library(readr)\n  df <- read_csv(url)\n  return(df)\n}\n\nhub_url <- \"https://github.com/JMHumphreys/flusion/raw/main/flusion/flusion_v2.csv\"\n\nmyFlusion <- as.data.frame(get_fusion(hub_url))\n\n\nhead(myFlusion)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|date       | year| epiweek|abbreviation |location |location_name | q_0.025| q_0.25| q_0.50| q_0.75| q_0.975|age_class |\n|:----------|----:|-------:|:------------|:--------|:-------------|-------:|------:|------:|------:|-------:|:---------|\n|2010-10-09 | 2010|      40|AL           |01       |Alabama       |    0.13|   0.43|   0.80|   1.48|    4.83|overall   |\n|2010-10-09 | 2010|      40|AK           |02       |Alaska        |    0.04|   0.14|   0.26|   0.48|    1.58|overall   |\n|2010-10-09 | 2010|      40|AZ           |04       |Arizona       |    2.68|   8.71|  16.12|  29.72|   93.15|overall   |\n|2010-10-09 | 2010|      40|AR           |05       |Arkansas      |    0.08|   0.25|   0.47|   0.87|    2.82|overall   |\n|2010-10-09 | 2010|      40|CA           |06       |California    |    1.81|   5.89|  10.93|  20.24|   64.55|overall   |\n|2010-10-09 | 2010|      40|CO           |08       |Colorado      |    1.12|   3.65|   6.77|  12.55|   40.19|overall   |\n\n</div>\n:::\n:::\n\n\n#### Data attributes:\n\n-   *date*: Date of the reported epidemiological week (epiweek) based on a Saturday start.\\\n-   *year*: Year of estimate\\\n-   *epiweek*: The epidemiological week\\\n-   *abbreviation*: U.S. State or Territory abbreviation.\\\n-   *location*: Numeric location code based on FIPS.\\\n-   *location_name*: Name of U.S. State or Territory.\\\n-   *age_class*: Nine age group classes and an \"overall\" category for totals (all ages).Â \\\n-   Columns beginning with *q\\_* provide the 0.025, 0.25, 0.5, 0.75, and 0.975 quantiles for estimated flu hospitalizations.\n\n## Select Data\n\nThe *age_class* column defines data subsets that can be partitioned for analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(myFlusion$age_class)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"overall\"  \"0-4 yr\"   \"18-29 yr\" \"30-39 yr\" \"40-49 yr\" \"5-17 yr\" \n [7] \"50-64 yr\" \"65-74 yr\" \"75-84 yr\" \"85+\"     \n```\n:::\n:::\n\n\n## 2022-2023 Season by Age\n\n\n::: {.cell}\n\n```{.r .cell-code}\nseason2022_23 <- myFlusion %>% \n  filter(age_class != \"overall\",\n         date >= as_date(\"2022-10-01\"))\n\nggplot(season2022_23, aes(date, q_0.50, fill=age_class), col = \"transparent\") +\n  geom_bar(position=\"stack\", stat=\"identity\") +\n   viridis::scale_fill_viridis(\"Age Group\",\n                             discrete=T,\n                             option = \"turbo\",\n                             direction = -1,\n                             na.value = \"white\") +\n    scale_x_date(date_breaks = \"2 week\", date_labels = \"%b-%d-%Y\") +\n    xlab(\" \") +\n    ylab(\"Hospitalizations\") + \n    ggtitle(\" \") +\n    theme_classic() +\n    theme(plot.margin = unit(c(2,0.5,2,0.5), \"cm\"),\n      panel.grid.minor = element_blank(),\n      panel.grid.major = element_blank(),\n      panel.background = element_blank(),\n      plot.background = element_blank(),\n      panel.border = element_blank(),\n      legend.title = element_text(size = 16, face = \"bold\", hjust=0.5),\n      legend.text = element_text(size=10, face=\"bold\"),\n      strip.text = element_text(size=16, face=\"bold\"),\n      strip.background = element_blank(),\n      legend.position = c(0.7, 0.5),\n      legend.direction = \"vertical\",\n      legend.key.width = unit(2,\"line\"),\n      axis.text.y = element_text(face=\"bold\", size=14),\n      axis.text.x = element_text(face=\"bold\", size=14, angle = 60, hjust=1),\n      axis.title.x = element_text(size=22, face=\"bold\"),\n      axis.title.y = element_text(size=22, face=\"bold\"),\n      plot.title = element_text(size=25, face=\"bold\", hjust=0.5)) \n```\n\n::: {.cell-output-display}\n![](explore_files/figure-html/unnamed-chunk-3-1.png){width=768}\n:::\n:::\n\n\n## Plot National Totals\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnatl_sums <- myFlusion %>%\n  filter(age_class == \"overall\") %>%\n  group_by(date) %>%\n  summarise(Q0.25 = sum(q_0.25),\n            Q0.50 = sum(q_0.50),\n            Q0.75 = sum(q_0.75))\n\n\nggplot(natl_sums, aes(date, Q0.50)) +  \n  geom_ribbon(aes(ymin=Q0.25, ymax=Q0.75),fill=\"steelblue\", alpha = 0.8) +\n  geom_line(linewidth = 0.5) +\n  scale_x_date(date_breaks = \"6 month\", date_labels = \"%b-%Y\") +\n  ylab(\"Estimated Hospitalizations\") +\n  xlab(\" \") +\n  theme_minimal() +\n  theme(plot.margin = unit(c(2,0.1,2,0.1), \"cm\"),\n        panel.grid.minor = element_line(color = \"gray90\", linewidth = 0.25, linetype = 1),\n        panel.grid.major = element_line(color = \"gray60\", linewidth = 0.5, linetype = 1),\n        panel.background = element_blank(),\n        plot.background = element_blank(),\n        legend.position=\"none\",\n        legend.text = element_text(size=12, face=\"bold\"),\n        legend.title = element_text(size=16, face=\"bold\"),\n        axis.title.x =  element_text(size=16, face=\"bold\"),\n        axis.title.y = element_text(size=16, face=\"bold\"),\n        axis.text.x =  element_text(size=14, face=\"bold\", angle=60, hjust=1),\n        axis.text.y = element_text(size=12, face=\"bold\"),\n        plot.title = element_text(size=22, face=\"bold\"))\n```\n\n::: {.cell-output-display}\n![](explore_files/figure-html/unnamed-chunk-4-1.png){width=768}\n:::\n:::\n\n\n## Plot States\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\nrandom_states <- sample(myFlusion$abbreviation, size=4)\n\nstates_plot <- myFlusion %>%\n   filter(age_class == \"overall\") %>%\n  filter(abbreviation %in% random_states)\n\nggplot(states_plot, aes(date, q_0.50)) +  \n  geom_ribbon(aes(ymin=q_0.025, ymax=q_0.975),fill=\"steelblue\", alpha = 0.3) +\n  geom_ribbon(aes(ymin=q_0.25, ymax=q_0.75),fill=\"steelblue\", alpha = 0.5) +\n  geom_line(linewidth = 0.5) +\n  scale_x_date(date_breaks = \"6 month\", date_labels = \"%b-%Y\") +\n  facet_grid(rows = vars(location_name), scales = \"free_y\") +\n  ylab(\"Estimated Hospitalizations\") +\n  xlab(\" \") +\n  theme_minimal() +\n  theme(plot.margin = unit(c(0.1,0.1,0.1,0.1), \"cm\"),\n        panel.grid.minor = element_line(color = \"gray90\", linewidth = 0.25, linetype = 1),\n        panel.grid.major = element_line(color = \"gray60\", linewidth = 0.5, linetype = 1),\n        panel.background = element_blank(),\n        plot.background = element_blank(),\n        strip.text = element_text(size=14, face=\"bold\"),\n        strip.background = element_blank(),\n        legend.position=\"none\",\n        legend.title = element_text(size=16, face=\"bold\"),\n        axis.title.x =  element_text(size=16, face=\"bold\"),\n        axis.title.y = element_text(size=16, face=\"bold\"),\n        axis.text.x =  element_text(size=12, face=\"bold\", angle=60, hjust=1),\n        axis.text.y = element_text(size=12, face=\"bold\"),\n        plot.title = element_text(size=22, face=\"bold\"))\n```\n\n::: {.cell-output-display}\n![](explore_files/figure-html/unnamed-chunk-5-1.png){width=768}\n:::\n:::\n\n\n## Shorter Term\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(111)\nrandom_states <- sample(myFlusion$abbreviation, size=4)\n\nrandom_yr <- sample(myFlusion$year, size=1)\n\n\n\nstates_plot_yr <- myFlusion %>%\n   filter(age_class == \"overall\") %>%\n  filter(abbreviation %in% random_states,\n         year == random_yr | year == (random_yr + 1))\n\nggplot(states_plot_yr, aes(date, q_0.50)) +  \n  geom_ribbon(aes(ymin=q_0.025, ymax=q_0.975),fill=\"steelblue\", alpha = 0.3) +\n  geom_ribbon(aes(ymin=q_0.25, ymax=q_0.75),fill=\"steelblue\", alpha = 0.5) +\n  geom_line(linewidth = 0.5) +\n  scale_x_date(date_breaks = \"6 month\", date_labels = \"%b-%Y\") +\n  facet_grid(rows = vars(location_name), scales = \"free_y\") +\n  ylab(\"Estimated Hospitalizations\") +\n  xlab(\" \") +\n  theme_minimal() +\n  theme(plot.margin = unit(c(0.1,0.1,0.1,0.1), \"cm\"),\n        panel.grid.minor = element_line(color = \"gray90\", linewidth = 0.25, linetype = 1),\n        panel.grid.major = element_line(color = \"gray60\", linewidth = 0.5, linetype = 1),\n        panel.background = element_blank(),\n        plot.background = element_blank(),\n        strip.text = element_text(size=14, face=\"bold\"),\n        strip.background = element_blank(),\n        legend.position=\"none\",\n        legend.title = element_text(size=16, face=\"bold\"),\n        axis.title.x =  element_text(size=16, face=\"bold\"),\n        axis.title.y = element_text(size=16, face=\"bold\"),\n        axis.text.x =  element_text(size=16, face=\"bold\"),\n        axis.text.y = element_text(size=12, face=\"bold\"),\n        plot.title = element_text(size=22, face=\"bold\"))\n```\n\n::: {.cell-output-display}\n![](explore_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "explore_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}